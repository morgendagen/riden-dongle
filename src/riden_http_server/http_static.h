// SPDX-FileCopyrightText: 2024 Peder Toftegaard Olsen
//
// SPDX-License-Identifier: MIT

#pragma once

#include <sys/pgmspace.h>

static const char HTML_HEADER[] PROGMEM =
    "<html>"
    "    <head>"
    "        <title>Riden Multi-Purpose WiFi Dongle</title>"
    "        <style>"
    "            body {"
    "                font-family: sans-serif;"
    "                width: 50%;"
    "                min-width: 600px;"
    "                margin: 10px auto 0 auto;"
    "                color: #383428;"
    "            }"
    "            div {"
    "               margin-bottom: 6px;"
    "            }"
    "            div.header {"
    "                margin-bottom: 10px;"
    "            }"
    "            a#configure {float:right;}"
    "            div.box {"
    "                background-color: #E4E4E2;"
    "                margin-top: 10px;"
    "                padding: 4px;"
    "            }"
    "            div.danger {"
    "                background-color: #ED2939;"
    "            }"
    "            .danger {"
    "                color: white;"
    "            }"
    "            .danger a, .danger a:hover, .danger a:active, .danger a:visited {"
    "                color: white;"
    "            }"
    "            .box table {"
    "                width: 100%;"
    "            }"
    "            .box h2 {"
    "                text-align: center;"
    "                margin: 0 0 8px 0;"
    "            }"
    "            .box td,th {"
    "                text-align: left;"
    "            }"
    "            table.info th {text-align: right; padding-right: 10px; width:50%;}"
    "            table.info td {text-align: left; padding-left: 10px; width:50%;}"
    "            table.clients th {text-align: left}"
    "            table.clients td {text-align: left}"
    "            table.clients form {display: inline}"
    "            .bigtext {"
    "              font-size: 3em;"
    "              font-weight: bold;"
    "              font-family: 'Noto Sans Mono', monospace;"
    "              text-align: right !important;"
    "              white-space: nowrap;"
    "              width: 8ch;"
    "            }"
    "            .smalltext {"
    "              font-size: 1em;"
    "              text-align: right !important;"
    "              white-space: nowrap;"
    "            }"
    "            span.smalltext {"
    "              font-weight: bold;"
    "              font-family: 'Noto Sans Mono', monospace;"
    "              width: 7ch;"
    "            }"
    "            .onoff { text-align: center !important;}"
    "            table.control {border-collapse: collapse; width: 100%}"
    "            table.control td, table.control th {padding-left: 10px; padding-right: 10px;}"
    "            table.control th {text-align: center;}"
    "            table.control th:nth-child(1), table.control td:nth-child(1) {text-align: right; white-space: nowrap;}"
    "            table.control td:nth-child(2) {text-align: center;white-space: nowrap;}"
    "            .onoff button { font-size: 1.5em; }"
    "            button.is_on {background-color: #0f0 !important;color: black !important;}"
    "            .control button {"
    "              margin: 0px 0px 0px 0px;"
    "              color: white;"
    "              background-color: #666;"
    "              padding: 4px 12px;"
    "              border-radius: 4px;"
    "              border: 1px solid #888;"
    "              width: 100%;"
    "              cursor: pointer;"
    "            }"
    "            .control input[type='number'] {font-family: 'Noto Sans Mono', monospace; font-size: 1.2em; text-align:right;}"
    "        </style>"
    "    </head>"
    "    <body>"
    "        <a id='home' href='/'>Home</a>&nbsp;"
    "        <a id='control' href='/control/'>Control</a>"
    "        <a id='configure' href='/config/'>Configure</a>";

static const char HTML_FOOTER[] PROGMEM =
    "    </body>"
    "</html>";

static const char HTML_CONFIG_BODY_1[] PROGMEM =
    "<form method='post'>"
    "    <div class='box'>"
    "        <h2>Dongle Configuration</h2>"
    "        <table class='info'>"
    "            <tbody>"
    "                <tr>"
    "                    <th>Time Zone</th>"
    "                    <td><select name='timezone'>";

static const char HTML_CONFIG_BODY_2[] PROGMEM =
    "                    </select></td>"
    "                </tr>"
    "                <tr>"
    "                    <th>UART baudrate</th>"
    "                    <td><select name='uart_baudrate'>";

static const char HTML_CONFIG_BODY_3[] PROGMEM =
    "                    </select></td>"
    "                </tr>"
    "                <tr><th></th><td><input type='submit' value='Save'></td></tr>"
    "            </tbody>"
    "        </table>"
    "    </div>"
    "</form>"
    "<form method='post' action='/firmware/update/' enctype='multipart/form-data'>"
    "    <div class='box'>"
    "        <h2>Firmware Update</h2>"
    "        <table class='info'>"
    "            <tbody>"
    "                <tr>"
    "                    <th>Firmware .bin file</th>"
    "                    <td><input type='file' name='firmware' accept='.bin,.gz'></td>"
    "                </tr>"
    "                <tr><th></th><td><input type='submit' value='Update'></td></tr>"
    "            </tbody>"
    "        </table>"
    "    </div>"
    "</form>"
    "<div class='box danger'>"
    "    <h2>Danger Zone</h2>"
    "    <a href='/reboot/dongle/'>Reboot Dongle</a><br>"
    "    <a href='/reboot/dongle/?config_portal=true'>Reboot Dongle to Web Configuration Portal</a><br>"
    "</div>";

static const char HTML_REBOOTING_DONGLE_BODY[] PROGMEM =
    "<div class='box'>"
    "    <h2>Dongle is Rebooting</h2>"
    "    <div><p>Redirecting to main page in <span id='counter'>10</span> seconds.</p>"
    "    <p><a href='/'>Return to main page</a></p>"
    "    </div>"
    "</div>"
    "<script>"
    "    setInterval(function() {"
    "        var div = document.querySelector('#counter');"
    "        var count = div.textContent * 1 - 1;"
    "        div.textContent = count;"
    "        if (count <= 0) {"
    "            window.location.replace('/');"
    "        }"
    "    }, 1000);"
    "</script>";

static const char HTML_REBOOTING_DONGLE_UPDATE_BODY[] PROGMEM =
    "<div class='box'>"
    "    <h2>Updated Dongle Firmware</h2>"
    "    <div><p>The dongle is now rebooting.</p>"
    "    <p>Redirecting to main page in <span id='counter'>20</span> seconds.</p>"
    "    <p><a href='/'>Return to main page</a></p>"
    "    </div>"
    "</div>"
    "<script>"
    "    setInterval(function() {"
    "        var div = document.querySelector('#counter');"
    "        var count = div.textContent * 1 - 1;"
    "        div.textContent = count;"
    "        if (count <= 0) {"
    "            window.location.replace('/');"
    "        }"
    "    }, 1000);"
    "</script>";

static const char HTML_DONGLE_UPDATE_1[] PROGMEM =
    "<div class='box'>"
    "    <h2>Dongle Firmware Failed to Update</h2>"
    "    <div><p>The failure is: <b>";

static const char HTML_DONGLE_UPDATE_2[] PROGMEM =
    "</b>."
    "</div>";

static const char HTML_REBOOTING_DONGLE_CONFIG_PORTAL_BODY_1[] PROGMEM =
    "<div class='box'>"
    "    <h2>Dongle is Rebooting</h2>"
    "    <div>An access point named <b>";

static const char HTML_REBOOTING_DONGLE_CONFIG_PORTAL_BODY_2[] PROGMEM =
    "</b> should show up shortly.</div>"
    "    <p>Connect to it and the config portal will show up.</p>";

static const char HTML_NO_CONNECTION_BODY[] PROGMEM =
    "<div class='box'>"
    "    <h2>Unable to communicate with power supply</h2>"
    "    <p>Make sure you have configured the power supply for TTL"
    " at the <a href='/config/'>configured</a> baudrate.</p>"
    "    <p>You must power-cycle the power supply if you modified"
    " its configuration.</p>"
    "</div>";


// Images are converted with https://www.base64-image.de/
static const char HTML_CONTROL_BODY[] PROGMEM = 
    "<div class=\"box\">"
    "  <a style=\"float: right\" href=\"/psu/\">Details</a>"
    "  <h2>Power Supply Control</h2>"
    "  <div>"
    "    <table class=\"control\">"
    "      <tbody>"
    "        <colgroup>"
    "          <col width=\"20%\" />"
    "          <col width=\"1%\" />"
    "          <col width=\"1%\" />"
    "          <col width=\"20%\" />"
    "        </colgroup>"
    "        <tr>"
    "          <th>Set</th>"
    "          <th></th>"
    "          <th>Output</th>"
    "          <th></th>"
    "        </tr>"
    "        <tr>"
    "          <td><input type=\"number\" id=\"set_v\" size=\"6\" value=\"\" min=\"0\" max=\"60\" step=\"0.01\"/></td>"
    "          <td><button id=\"setv\" onclick=\"setv()\">V-Set &gt;</button></td>"
    "          <td><pre class=\"bigtext\" id=\"out_v\"> -.-- V</pre></td>"
    "          <td>"
    "            <img"
    "              id=\"cv\""
    "              src=\"data:image/png;base64,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\""
    "              style=\"visibility: hidden\""
    "            />"
    "          </td>"
    "        </tr>"
    "        <tr>"
    "          <td><input type=\"number\" id=\"set_c\" size=\"6\" value=\"\" min=\"0\" max=\"30\" step=\"0.01\"/></td>"
    "          <td><button id=\"seti\" onclick=\"seti()\">I-Set &gt;</button></td>"
    "          <td><pre class=\"bigtext\" id=\"out_i\"> -.-- A</pre></td>"
    "          <td>"
    "            <img"
    "              id=\"cc\""
    "              src=\"data:image/png;base64,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\""
    "              style=\"visibility: hidden\""
    "            />"
    "          </td>"
    "        </tr>"
    "        <tr>"
    "          <td colspan=\"2\">"
    "            <table width=\"100%\" class=\"smalltext\">"
    "              <tr>"
    "                <td style=\"text-align: right; vertical-align: top\">"
    "                  <pre>Ah:<span id='ah'>   0.000</span> Ah<br>Wh:<span id='wh'>   0.000</span> Wh</pre>"
    "                </td>"
    "                <td width=\"1%\" style=\"text-align: right\">"
    "                  <pre>ext:<span id='ext_t_c'>-100.0</span>&deg;C<br>int:<span id='int_t_c'>   0.0</span>&deg;C<br>batt:<span id='batt_v'>  0.00</span> V</pre>"
    "                </td>"
    "              </tr>"
    "            </table>"
    "          </td>"
    "          <td class=\"onoff\">"
    "            <button id=\"toggle\" onclick=\"toggle()\">ON/OFF</button>"
    "          </td>"
    "          <td>"
    "            <img"
    "              id=\"batt\""
    "              src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAAhCAYAAABEM4KbAAAEDmlDQ1BrQ0dDb2xvclNwYWNlR2VuZXJpY1JHQgAAOI2NVV1oHFUUPpu5syskzoPUpqaSDv41lLRsUtGE2uj+ZbNt3CyTbLRBkMns3Z1pJjPj/KRpKT4UQRDBqOCT4P9bwSchaqvtiy2itFCiBIMo+ND6R6HSFwnruTOzu5O4a73L3PnmnO9+595z7t4LkLgsW5beJQIsGq4t5dPis8fmxMQ6dMF90A190C0rjpUqlSYBG+PCv9rt7yDG3tf2t/f/Z+uuUEcBiN2F2Kw4yiLiZQD+FcWyXYAEQfvICddi+AnEO2ycIOISw7UAVxieD/Cyz5mRMohfRSwoqoz+xNuIB+cj9loEB3Pw2448NaitKSLLRck2q5pOI9O9g/t/tkXda8Tbg0+PszB9FN8DuPaXKnKW4YcQn1Xk3HSIry5ps8UQ/2W5aQnxIwBdu7yFcgrxPsRjVXu8HOh0qao30cArp9SZZxDfg3h1wTzKxu5E/LUxX5wKdX5SnAzmDx4A4OIqLbB69yMesE1pKojLjVdoNsfyiPi45hZmAn3uLWdpOtfQOaVmikEs7ovj8hFWpz7EV6mel0L9Xy23FMYlPYZenAx0yDB1/PX6dledmQjikjkXCxqMJS9WtfFCyH9XtSekEF+2dH+P4tzITduTygGfv58a5VCTH5PtXD7EFZiNyUDBhHnsFTBgE0SQIA9pfFtgo6cKGuhooeilaKH41eDs38Ip+f4At1Rq/sjr6NEwQqb/I/DQqsLvaFUjvAx+eWirddAJZnAj1DFJL0mSg/gcIpPkMBkhoyCSJ8lTZIxk0TpKDjXHliJzZPO50dR5ASNSnzeLvIvod0HG/mdkmOC0z8VKnzcQ2M/Yz2vKldduXjp9bleLu0ZWn7vWc+l0JGcaai10yNrUnXLP/8Jf59ewX+c3Wgz+B34Df+vbVrc16zTMVgp9um9bxEfzPU5kPqUtVWxhs6OiWTVW+gIfywB9uXi7CGcGW/zk98k/kmvJ95IfJn/j3uQ+4c5zn3Kfcd+AyF3gLnJfcl9xH3OfR2rUee80a+6vo7EK5mmXUdyfQlrYLTwoZIU9wsPCZEtP6BWGhAlhL3p2N6sTjRdduwbHsG9kq32sgBepc+xurLPW4T9URpYGJ3ym4+8zA05u44QjST8ZIoVtu3qE7fWmdn5LPdqvgcZz8Ww8BWJ8X3w0PhQ/wnCDGd+LvlHs8dRy6bLLDuKMaZ20tZrqisPJ5ONiCq8yKhYM5cCgKOu66Lsc0aYOtZdo5QCwezI4wm9J/v0X23mlZXOfBjj8Jzv3WrY5D+CsA9D7aMs2gGfjve8ArD6mePZSeCfEYt8CONWDw8FXTxrPqx/r9Vt4biXeANh8vV7/+/16ffMD1N8AuKD/A/8leAvFY9bLAAAAOGVYSWZNTQAqAAAACAABh2kABAAAAAEAAAAaAAAAAAACoAIABAAAAAEAAAApoAMABAAAAAEAAAAhAAAAANOY7aQAAAEySURBVFgJ7ZhBCsIwEEV/ooJYdCMU69KNK09ij1vv4cojKHQlBUWwGhOlYRRpaRJswMymM20yef0zbWkYiI3BxQqMnOnG3UmGI0oNoh0FGGWDbqi+rHpJbxr0CekbYMVcgTJfASvQU3oFj9CrYi+PU3D0XZId1hedLtkMtW/rOINUgBTsM7YB5TaTfzWXzTAQyMxYaXmbgKnKTWPp9aF8FRmXu205246noGYS0gw/8I2VpGx1ZTctM83/P0q6UIsq9+n/j5KhJ2XtnTzdoSddKRl60pWSoSddKRl60pWSoSdtlFTq1fWizP1mNmpbfRZtFn67g4aAFyiRyJ8dH22Rlshxe22hjcDEUu5kHDJ/djMU4BZ3nCGY3lXzCZQCqgprSBXM41hMhPK6tUJS7fNcsz0A2HpaTvrlARMAAAAASUVORK5CYII=\""
    "              style=\"display: none\""
    "            />"
    "            <img"
    "              id=\"nobatt\""
    "              src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAAhCAYAAABEM4KbAAAEDmlDQ1BrQ0dDb2xvclNwYWNlR2VuZXJpY1JHQgAAOI2NVV1oHFUUPpu5syskzoPUpqaSDv41lLRsUtGE2uj+ZbNt3CyTbLRBkMns3Z1pJjPj/KRpKT4UQRDBqOCT4P9bwSchaqvtiy2itFCiBIMo+ND6R6HSFwnruTOzu5O4a73L3PnmnO9+595z7t4LkLgsW5beJQIsGq4t5dPis8fmxMQ6dMF90A190C0rjpUqlSYBG+PCv9rt7yDG3tf2t/f/Z+uuUEcBiN2F2Kw4yiLiZQD+FcWyXYAEQfvICddi+AnEO2ycIOISw7UAVxieD/Cyz5mRMohfRSwoqoz+xNuIB+cj9loEB3Pw2448NaitKSLLRck2q5pOI9O9g/t/tkXda8Tbg0+PszB9FN8DuPaXKnKW4YcQn1Xk3HSIry5ps8UQ/2W5aQnxIwBdu7yFcgrxPsRjVXu8HOh0qao30cArp9SZZxDfg3h1wTzKxu5E/LUxX5wKdX5SnAzmDx4A4OIqLbB69yMesE1pKojLjVdoNsfyiPi45hZmAn3uLWdpOtfQOaVmikEs7ovj8hFWpz7EV6mel0L9Xy23FMYlPYZenAx0yDB1/PX6dledmQjikjkXCxqMJS9WtfFCyH9XtSekEF+2dH+P4tzITduTygGfv58a5VCTH5PtXD7EFZiNyUDBhHnsFTBgE0SQIA9pfFtgo6cKGuhooeilaKH41eDs38Ip+f4At1Rq/sjr6NEwQqb/I/DQqsLvaFUjvAx+eWirddAJZnAj1DFJL0mSg/gcIpPkMBkhoyCSJ8lTZIxk0TpKDjXHliJzZPO50dR5ASNSnzeLvIvod0HG/mdkmOC0z8VKnzcQ2M/Yz2vKldduXjp9bleLu0ZWn7vWc+l0JGcaai10yNrUnXLP/8Jf59ewX+c3Wgz+B34Df+vbVrc16zTMVgp9um9bxEfzPU5kPqUtVWxhs6OiWTVW+gIfywB9uXi7CGcGW/zk98k/kmvJ95IfJn/j3uQ+4c5zn3Kfcd+AyF3gLnJfcl9xH3OfR2rUee80a+6vo7EK5mmXUdyfQlrYLTwoZIU9wsPCZEtP6BWGhAlhL3p2N6sTjRdduwbHsG9kq32sgBepc+xurLPW4T9URpYGJ3ym4+8zA05u44QjST8ZIoVtu3qE7fWmdn5LPdqvgcZz8Ww8BWJ8X3w0PhQ/wnCDGd+LvlHs8dRy6bLLDuKMaZ20tZrqisPJ5ONiCq8yKhYM5cCgKOu66Lsc0aYOtZdo5QCwezI4wm9J/v0X23mlZXOfBjj8Jzv3WrY5D+CsA9D7aMs2gGfjve8ArD6mePZSeCfEYt8CONWDw8FXTxrPqx/r9Vt4biXeANh8vV7/+/16ffMD1N8AuKD/A/8leAvFY9bLAAAAOGVYSWZNTQAqAAAACAABh2kABAAAAAEAAAAaAAAAAAACoAIABAAAAAEAAAApoAMABAAAAAEAAAAhAAAAANOY7aQAAAJ8SURBVFgJ5ZiPj5owFMcfg5zyQwU5T5zbnLf//z9ZLpfLctmWLHqX7OaiIiAnSkDGI4OhyXOkNdHEGkLbb9v38b1SWgQoJVmWE0VRSjWnya5WKwiCQMitFxkENHQDer1erp3sPvk9Adu2C9A3SFKv1xPDOA9A5LG6FrTbbUDHYVlAQKzoWaf3IAKVU+5RSRTFowAqqgLNVquw4Xse+P5rUWbJoEe9dByJpfN+HwQcfBxA56ZTSPPZHJ5GY25QHPAokM1mMwN0XRcc24GW3gLz2gTXcU8LqSgqGKaeea71N8zJNoEojmC73Wb1uqFDkv4wuQuHGZjJkwg4GH7YCS+CIBReeWqbbcALE0/4mSBVTckAPdeD6XSaM5F30zSz8CMoy8OUrZPk6P8RlstlFkZJlIC68I/gXOVJTJ4sG9QajTT0g3LVTj6Kop0yS4HLkywGWfpwe9J1PPj29TtpGxf169L6STY8IHBDSpIImqqSJtZBQGpVBW5IVVOh/75P2luv16RWVbiMOblYLODxyyPplFd/BTfWv3c62fCAwB3uWq2WLdSUjTiOKalyPTckHje6Vpc06C99UqsqXMactO0FPNw/kE4JgjVYPdrTZMeScIRwy9B/Ry9Bk1+Tkjm2LDdkekY6+OA46T6SN13GnJzhHvHzHemszSaEt32+kyhXuDudDmiaRgLmQk2u51mmOxMkfl0Y/RjB8NMQrmpXlQw/j59hNp1VarvfiAkyjmJ4+fmSnlvs/fHIchhugHUDLEiSlDTS3fXt8JY0cCph/DQGPKJkH6zOETQHDMNQKL6qnRNoGRCjWMzJdL4IadgTx+VffHmnx3w+L5yHY/0Bi73kZxTk95cAAAAASUVORK5CYII=\""
    "              style=\"display: inline\""
    "            />"
    "            <img"
    "              id=\"ocp\""
    "              src=\"data:image/png;base64,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\""
    "              style=\"display: none\""
    "            />"
    "            <img"
    "              id=\"ovp\""
    "              src=\"data:image/png;base64,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\""
    "              style=\"display: none\""
    "            />"
    "          </td>"
    "        </tr>"
    "      </tbody>"
    "    </table>"
    "  </div>"
    "</div>"
    "<script>"
    "  function set_data(data, full_set = false) {"
    "    if (data === \"\") {"
    "      return;"
    "    }"
    "    const obj = JSON.parse(data);"
    "    self.out_v.innerHTML = obj.out_v.toFixed(2).padStart(6, \" \") + \" V\";"
    "    self.out_i.innerHTML = obj.out_c.toFixed(2).padStart(6, \" \") + \" A\";"
    "    if (full_set) {"
    "      self.set_v.value = obj.set_v.toFixed(2);"
    "      self.set_c.value = obj.set_c.toFixed(2);"
    "    }"
    "    document.getElementById(\"set_v\").setAttribute(\"max\", obj.max_v.toFixed(2));"
    "    document.getElementById(\"set_c\").setAttribute(\"max\", obj.max_c.toFixed(2));"
    "    if (obj.out_on) {"
    "      document.getElementById(\"toggle\").classList.add(\"is_on\");"
    "    } else {"
    "      document.getElementById(\"toggle\").classList.remove(\"is_on\");"
    "    }"
    "    if (obj.cvmode) {"
    "      document.getElementById(\"cv\").style.visibility = \"visible\";"
    "      document.getElementById(\"cc\").style.visibility = \"hidden\";"
    "    } else {"
    "      document.getElementById(\"cv\").style.visibility = \"hidden\";"
    "      document.getElementById(\"cc\").style.visibility = \"visible\";"
    "    }"
    "    if (obj.ext_t_c === null) {"
    "      self.ext_t_c.innerHTML = \"  --.-\";"
    "    } else {"
    "      self.ext_t_c.innerHTML = obj.ext_t_c.toFixed(1).padStart(6, \" \");"
    "    }"
    "    self.int_t_c.innerHTML = obj.int_t_c.toFixed(1).padStart(6, \" \");"
    "    self.batt_v.innerHTML = obj.batt_v.toFixed(2).padStart(6, \" \");"
    "    self.ah.innerHTML = obj.ah.toFixed(3).padStart(8, \" \");"
    "    self.wh.innerHTML = obj.wh.toFixed(3).padStart(8, \" \");"
    "    let img = \"nobatt\";"
    "    if (obj.prot === \"OVP\") {"
    "      img = \"ovp\";"
    "    } else if (obj.prot === \"OCP\") {"
    "      img = \"ocp\";"
    "    } else if (obj.batt_mode) {"
    "      img = \"batt\";"
    "    }"
    "    document.getElementById(\"batt\").style.display = \"none\";"
    "    document.getElementById(\"nobatt\").style.display = \"none\";"
    "    document.getElementById(\"ovp\").style.display = \"none\";"
    "    document.getElementById(\"ocp\").style.display = \"none\";"
    "    document.getElementById(img).style.display = \"inline\";"
    "  }"
    "  let t;"
    "  function tick(full_set = false) {"
    "    try {"
    "      fetch(\"/status\")"
    "        .then((response) => {"
    "          if (!response.ok) {"
    "            return \"\";"
    "          }"
    "          return response.text();"
    "        })"
    "        .then((data) => {"
    "          if (data !== \"\") {"
    "            set_data(data, full_set);"
    "          } else {"
    "            console.warn(\"No data received from /status\");"
    "          }"
    "          if (typeof t === \"number\") {"
    "            clearTimeout(t);"
    "          }"
    "          t = setTimeout(tick, 1000);"
    "        });"
    "    } catch (e) {"
    "      console.error(\"Error fetching status:\", e);"
    "      if (typeof t === \"number\") {"
    "        clearTimeout(t);"
    "      }"
    "      t = setTimeout(tick, 1000);"
    "    }"
    "  }"
    "  function setv() {"
    "    const v = self.set_v.value.trim();"
    "    if (v === \"\") {"
    "      alert(\"Please enter a voltage\");"
    "      return;"
    "    }"
    "    document.body.style.cursor = \"wait\";"
    "    document.getElementById(\"setv\").style.cursor = \"wait\";"
    "    try {"
    "      fetch(\"/set_v\", { method: \"POST\", body: v }).then((response) => {"
    "        document.body.style.cursor = \"default\";"
    "        document.getElementById(\"setv\").style.cursor = \"pointer\";"
    "        if (!response.ok) {"
    "          throw new Error(\"ERR: \" + response.statusText);"
    "        }"
    "      });"
    "    } catch (e) {"
    "      console.error(\"Error setting voltage:\", e);"
    "      alert(\"Error setting voltage: \" + e.message);"
    "      document.body.style.cursor = \"default\";"
    "      document.getElementById(\"setv\").style.cursor = \"pointer\";"
    "    }"
    "  }"
    "  function seti() {"
    "    const v = self.set_c.value.trim();"
    "    if (v === \"\") {"
    "      alert(\"Please enter a current\");"
    "      return;"
    "    }"
    "    document.body.style.cursor = \"wait\";"
    "    document.getElementById(\"seti\").style.cursor = \"wait\";"
    "    try {"
    "      fetch(\"/set_i\", { method: \"POST\", body: v }).then((response) => {"
    "        document.body.style.cursor = \"default\";"
    "        document.getElementById(\"seti\").style.cursor = \"pointer\";"
    "        if (!response.ok) {"
    "          throw new Error(\"ERR: \" + response.statusText);"
    "        }"
    "      });"
    "    } catch (e) {"
    "      console.error(\"Error setting current:\", e);"
    "      alert(\"Error setting current: \" + e.message);"
    "      document.body.style.cursor = \"default\";"
    "      document.getElementById(\"seti\").style.cursor = \"pointer\";"
    "    }"
    "  }"
    "  function toggle() {"
    "    document.body.style.cursor = \"wait\";"
    "    document.getElementById(\"toggle\").style.cursor = \"wait\";"
    "    try {"
    "      fetch(\"/toggle_out\")"
    "        .then((response) => {"
    "          document.body.style.cursor = \"default\";"
    "          document.getElementById(\"toggle\").style.cursor = \"pointer\";"
    "          if (!response.ok) {"
    "            throw new Error(\"ERR: \" + response.statusText);"
    "          }"
    "          return response.text();"
    "        })"
    "        .then((data) => {"
    "          set_data(data, false);"
    "        });"
    "    } catch (e) {"
    "      console.error(\"Error in toggle:\", e);"
    "      alert(\"Error in toggle: \" + e.message);"
    "      document.body.style.cursor = \"default\";"
    "      document.getElementById(\"toggle\").style.cursor = \"pointer\";"
    "    }"
    "  }"
    "  window.addEventListener(\"load\", function () {"
    "    tick(true);"
    "  });"
    "</script>";

/**
 * @brief LXI identification document template.
 *
 * Substitution variables:
 *
 * 0 = Model
 * 1 = Serial Number
 * 2 = Firmware Revision
 * 3 = Hostname
 * 4 = IP Address
 * 5 = Subnet mask
 * 6 = MAC Address
 * 7 = IP Gateway
 * 8 = VISA Resource Address 1
 * 9 = VISA Resource Address 2
 */
static const char *LXI_IDENTIFICATION_TEMPLATE = R"==(<?xml version="1.0" encoding="UTF-8" ?>
<LXIDevice xmlns="http://www.lxistandard.org/InstrumentIdentification/1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.lxistandard.org/InstrumentIdentification/1.0/LXIIdentification.xsd">
    <Manufacturer>Riden</Manufacturer>
    <Model>${0}</Model>
    <SerialNumber>${1}</SerialNumber>
    <FirmwareRevision>${2}</FirmwareRevision>
    <ManufacturerDescription>Power Supply</ManufacturerDescription>
    <IdentificationURL>http://${3}.local/lxi/identification</IdentificationURL>
    <Interface xsi:type="NetworkInformation" InterfaceType="LXI" IPType="IPv4">
        <InstrumentAddressString>${8}</InstrumentAddressString>
        <InstrumentAddressString>${9}</InstrumentAddressString>
        <Hostname>${3}</Hostname>
        <IPAddress>${4}</IPAddress>
        <SubnetMask>${5}</SubnetMask>
        <MACAddress>${6}</MACAddress>
        <Gateway>${7}</Gateway>
        <DHCPEnabled>true</DHCPEnabled>
        <AutoIPEnabled>true</AutoIPEnabled>
    </Interface>
    <LXIVersion>1.5</LXIVersion>
</LXIDevice>
)==";
